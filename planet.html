<!DOCTYPE html>
input,textarea{width:100%;margin:6px 0;padding:8px;border-radius:6px;border:1px solid var(--border);background:transparent;color:var(--text)}
textarea{height:120px}
.viewer{margin-top:10px}
.reading body *{pointer-events:none}
.reading .viewer{pointer-events:auto}
.reading .toolbar, .reading input, .reading textarea, .reading button, .reading .chapter{display:none}


.like{cursor:pointer;font-size:18px;margin-left:6px}
.like.on{color:red}


.modeBtns button{margin-left:6px}
</style>
</head>
<body>
hello~æ­¡è¿ä¾†åˆ°Daydreamå°èªªç¶²ç«™
<div class="container">
<div class="toolbar">
<h1>ğŸ“š å°èªªæ›¸åŸ</h1>
<div class="modeBtns">
<button onclick="toggleDark()">ğŸŒ™</button>
<button onclick="toggleGreen()">ğŸŸ¢</button>
<button onclick="toggleReading()">ğŸ“–</button>
</div>
</div>


<h2>â• æ–°å¢å°èªª</h2>
<input id="novelTitle" placeholder="å°èªªåç¨±" />
<button class="primary" onclick="addNovel()">æ–°å¢å°èªª</button>


<div class="grid" id="bookGrid"></div>
</div>


<script>
let novels=JSON.parse(localStorage.getItem('novels'))||[]
let openIndex=null
let reading=false


const save=()=>localStorage.setItem('novels',JSON.stringify(novels))
const cn=n=>['é›¶','ä¸€','äºŒ','ä¸‰','å››','äº”','å…­','ä¸ƒ','å…«','ä¹','å'][n]||n
const chapterName=i=>`ç¬¬${cn(i+1)}ç« `


function toggleDark(){document.body.classList.toggle('dark');document.body.classList.remove('green');localStorage.setItem('mode','dark')}
function toggleGreen(){document.body.classList.toggle('green');document.body.classList.remove('dark');localStorage.setItem('mode','green')}
function toggleReading(){reading=!reading;document.body.classList.toggle('reading',reading)}


if(localStorage.getItem('mode')==='dark')document.body.classList.add('dark')
if(localStorage.getItem('mode')==='green')document.body.classList.add('green')


function addNovel(){const t=novelTitle.value.trim();if(!t)return alert('è«‹è¼¸å…¥åç¨±');novels.push({title:t,liked:false,chapters:[]});novelTitle.value='';save();render()}


function render(){
bookGrid.innerHTML=''
novels.forEach((n,i)=>{
const card=document.createElement('div')
card.className='card'
card.innerHTML=`<h3>${n.title}<span class='like ${n.liked?'on':''}'>â¤</span></h3><small>${n.chapters.length} ç« </small><div class='content'></div>`
card.querySelector('h3').onclick=()=>toggleOpen(i)
card.querySelector('.like').onclick=(e)=>{e.stopPropagation();n.liked=!n.liked;save();render()}
if(openIndex===i)renderChapters(card.querySelector('.content'),i)
bookGrid.appendChild(card)
})
}


function toggleOpen(i){openIndex=openIndex===i?null:i;render()}


function renderChapters(container,i){
const n=novels[i]
container.innerHTML=`<hr><input placeholder='ç« ç¯€æ¨™é¡Œï¼ˆå¯ç©ºï¼‰' id='ct${i}'><textarea placeholder='ç« ç¯€å…§å®¹' id='cc${i}'></textarea><button onclick='addChapter(${i})'>æ–°å¢ç« ç¯€</button>`
n.chapters.forEach((c,idx)=>{
const d=document.createElement('div')
d.className='chapter'
d.textContent=chapterName(idx)
d.onclick=()=>viewChapter(container,i,idx)
container.appendChild(d)
})
}


function addChapter(i){const t=document.getElementById('ct'+i).value;const c=document.getElementById('cc'+i).value;if(!c)return alert('è«‹å¡«å…§å®¹');novels[i].chapters.push({title:t,content:c,time:new Date().toLocaleString()});save();render()}


function viewChapter(container,i,idx){const c=novels[i].chapters[idx];const v=document.createElement('div');v.className='viewer';v.innerHTML=`<h4>${chapterName(idx)}</h4><small>${c.time}</small><p>${c.content.replace(/\n/g,'<br>')}</p>`;container.appendChild(v)}


render()
</script>


</body>
</html>
